<html>
<head>
	<title>sso-web-user 登入页面</title>
	<meta charset="utf-8"/>
	<script src="http://cdn.bootcss.com/jquery/3.1.1/jquery.js" type="application/javascript" charset="utf-8"></script>
	<script src="/static/js/common/artDialog/dialog-plus-min.js" type="application/javascript" charset="utf-8"></script>
	<script src="/static/js/common/base.js" type="application/javascript" charset="utf-8"></script>
	<script src="/static/js/common/ajax.js" type="application/javascript" charset="utf-8"></script>
	<link  href="/static/js/common/artDialog/dialog.css" type="text/css" rel="stylesheet"/>
	<style type="text/css">
		.login{
			height: 600px;
			width: 1200px;
			margin-top: 200px;
			margin-left: 200px;
		}
	</style>
</head>
<body>
	<div class="login">
		<input type="text" id='userName' name="cellphone" value="1304088" height="40px" width="100px"/><br/>
		<input type="password" id='password' name="userPwd" value="12321" height="40px" width="100px"/><br/>
		<input type="button" id='submit' value="登入" height="20px" width="60px"/>
	</div>
</body>
<script type='text/javascript'>
	ssoCount = 0;
	$('#submit').click(login);
	function login() {
        postForm("/user/login", {
            cellphone: $('#userName').val(),
            passWd: $('#password').val()
        }, ssoLogin, null, {async: false});
    }
    function ssoLogin(data) {
//        data.ssoUrls.forEach(function(val){
//            getJsonp("http:\/\/" + val + "/sso/login", {
//                token: data.ssoToken
//            }, function (res2) {
//				alert(JSON.stringify(res2));
//                console.log(JSON.stringify(res2));
//            }, null, {async: false});
//        });
		for(var i = 0; i < data.ssoUrls.length; i++){
			getJsonp("http:\/\/" + data.ssoUrls[i] + "/sso/login", {
				token: data.ssoToken
			}, function (res2) {
				ssoCount ++;
				console.log(JSON.stringify(res2));
			}, null, {async: false});
		}
		while(ssoCount == data.ssoUrls.length){
			break;
		}
		redictBackUrl();
    }
</script>
</html>
